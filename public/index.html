<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø³ÙŠØ§Ø¯Ø© | Siyadah â€” Ø£ØªÙ…ØªØ© Ø°ÙƒÙŠØ© Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠ</title>
<meta name="description" content="Ø³ÙŠØ§Ø¯Ø© â€” Ù…Ù†ØµØ© Ø£ØªÙ…ØªØ© Ø¹Ø±Ø¨ÙŠØ© Ø°ÙƒÙŠØ©. Ø§ÙƒØªØ¨ Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠ ÙˆØ³ÙŠØ§Ø¯Ø© ÙŠØ¨Ù†ÙŠ Ù„Ùƒ Ù†Ø¸Ø§Ù… Ø£ØªÙ…ØªØ© ÙƒØ§Ù…Ù„">
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ‘‘</text></svg>">
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0}
html,body,#root{height:100%;overflow:hidden}
body{font-family:'IBM Plex Sans Arabic',system-ui,sans-serif;background:#0A0A0F;color:#E8E8ED}
::-webkit-scrollbar{width:4px}
::-webkit-scrollbar-track{background:transparent}
::-webkit-scrollbar-thumb{background:#1E1E2E;border-radius:4px}
input::placeholder{color:#9494A8;opacity:0.6}
@keyframes wowSlideIn{from{opacity:0;transform:translateX(30px)}to{opacity:1;transform:translateX(0)}}
@keyframes wowPulse{0%,100%{opacity:1}50%{opacity:.3}}
@keyframes wowBlink{0%,50%{opacity:1}51%,100%{opacity:0}}
@keyframes chatPulse{0%,100%{opacity:1}50%{opacity:.3}}
@keyframes fadeUp{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
@keyframes slidePanel{from{opacity:0;transform:translateX(-16px)}to{opacity:1;transform:translateX(0)}}
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.9/babel.min.js"></script>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
const { useState, useEffect, useRef, useCallback } = React;

const T = {
  accent: "#6C5CE7", accentLight: "#A29BFE", success: "#00B894",
  warn: "#FDCB6E", danger: "#E17055", bg: "#0A0A0F", card: "#12121A",
  hover: "#1A1A25", text: "#E8E8ED", dim: "#9494A8", border: "#1E1E2E",
};

const MAX_MSG = 500, RATE_MS = 1500;
function sanitize(t) { if (!t || typeof t !== "string") return ""; return t.slice(0, MAX_MSG).replace(/[<>]/g, "").trim(); }

const FLOWS = {
  lead_capture: {
    displayName: "ğŸ¯ Ø¬Ø°Ø¨ ÙˆØªØ£Ù‡ÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡",
    desc: "Ø¹Ù…ÙŠÙ„ Ø¬Ø¯ÙŠØ¯ â†’ CRM â†’ ØªØ­Ù„ÙŠÙ„ AI â†’ ØªØ±Ø­ÙŠØ¨ â†’ Ø¥Ø´Ø¹Ø§Ø±",
    cat: "Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª", diff: "Ø³Ù‡Ù„",
    steps: [
      { icon: "ğŸ“Š", piece: "Google Sheets", action: "Ø­ÙØ¸ ÙÙŠ CRM", status: "needs_config" },
      { icon: "ğŸ¤–", piece: "OpenAI", action: "ØªØ­Ù„ÙŠÙ„ ÙˆØªØµÙ†ÙŠÙ Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ", status: "ready" },
      { icon: "ğŸ“§", piece: "Gmail", action: "Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© ØªØ±Ø­ÙŠØ¨", status: "needs_config" },
      { icon: "ğŸ’¬", piece: "Slack", action: "Ø¥Ø´Ø¹Ø§Ø± ÙØ±ÙŠÙ‚ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª", status: "needs_config" },
    ]
  },
  sales_followup: {
    displayName: "ğŸ“ Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„Ø°ÙƒÙŠØ©",
    desc: "ÙØ­Øµ ÙŠÙˆÙ…ÙŠ â†’ Ø¹Ù…Ù„Ø§Ø¡ Ø¨Ø¯ÙˆÙ† Ø±Ø¯ â†’ Ø¥ÙŠÙ…ÙŠÙ„ Ù…ØªØ§Ø¨Ø¹Ø© â†’ Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨",
    cat: "Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª", diff: "Ø³Ù‡Ù„",
    steps: [
      { icon: "ğŸ“Š", piece: "Google Sheets", action: "Ø¬Ù„Ø¨ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø¨Ø¯ÙˆÙ† Ø±Ø¯", status: "needs_config" },
      { icon: "ğŸ“§", piece: "Gmail", action: "Ø¥ÙŠÙ…ÙŠÙ„ Ù…ØªØ§Ø¨Ø¹Ø©", status: "needs_config" },
      { icon: "ğŸ’¬", piece: "Slack", action: "Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨", status: "needs_config" },
    ]
  },
  invoice_reminder: {
    displayName: "ğŸ’° ØªØ°ÙƒÙŠØ± Ø§Ù„ÙÙˆØ§ØªÙŠØ± Ø§Ù„Ø°ÙƒÙŠ",
    desc: "ÙØ­Øµ ÙŠÙˆÙ…ÙŠ â†’ ÙÙˆØ§ØªÙŠØ± Ù…ØªØ£Ø®Ø±Ø© â†’ ØªØ°ÙƒÙŠØ± â†’ ØªØµØ¹ÙŠØ¯",
    cat: "Ø§Ù„ÙÙˆØªØ±Ø©", diff: "Ù…ØªÙˆØ³Ø·",
    steps: [
      { icon: "ğŸ“Š", piece: "Google Sheets", action: "Ø¬Ù„Ø¨ Ø§Ù„ÙÙˆØ§ØªÙŠØ± ØºÙŠØ± Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø©", status: "needs_config" },
      { icon: "âš™ï¸", piece: "Code", action: "Ø­Ø³Ø§Ø¨ Ø£ÙŠØ§Ù… Ø§Ù„ØªØ£Ø®ÙŠØ±", status: "ready" },
      { icon: "ğŸ“§", piece: "Gmail", action: "ØªØ°ÙƒÙŠØ± Ù…Ù‡Ø°Ø¨ Ø¨Ø§Ù„Ø¯ÙØ¹", status: "needs_config" },
      { icon: "ğŸ’¬", piece: "Slack", action: "ØªØµØ¹ÙŠØ¯ Ù„Ù„Ø¥Ø¯Ø§Ø±Ø© (+14 ÙŠÙˆÙ…)", status: "needs_config" },
    ]
  },
  email_campaign: {
    displayName: "ğŸ“§ Ø­Ù…Ù„Ø© Ø¨Ø±ÙŠØ¯ÙŠØ© Ø°ÙƒÙŠØ©",
    desc: "Ø¹Ù…ÙŠÙ„ Ø¬Ø¯ÙŠØ¯ â†’ AI ÙŠÙƒØªØ¨ Ø¥ÙŠÙ…ÙŠÙ„ Ù…Ø®ØµØµ â†’ Ø¥Ø±Ø³Ø§Ù„ â†’ ØªØ³Ø¬ÙŠÙ„",
    cat: "Ø§Ù„ØªØ³ÙˆÙŠÙ‚", diff: "Ø³Ù‡Ù„",
    steps: [
      { icon: "ğŸ¤–", piece: "OpenAI", action: "ÙƒØªØ§Ø¨Ø© Ø¥ÙŠÙ…ÙŠÙ„ Ù…Ø®ØµØµ Ø¨Ù€ AI", status: "ready" },
      { icon: "ğŸ“§", piece: "Gmail", action: "Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„", status: "needs_config" },
      { icon: "ğŸ“Š", piece: "Google Sheets", action: "ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„", status: "needs_config" },
    ]
  },
  customer_satisfaction: {
    displayName: "â­ Ø§Ø³ØªØ¨ÙŠØ§Ù† Ø±Ø¶Ø§ + ØªØ­Ù„ÙŠÙ„ AI",
    desc: "Ø¨Ø¹Ø¯ 30 ÙŠÙˆÙ… â†’ Ø§Ø³ØªØ¨ÙŠØ§Ù† â†’ ØªØ­Ù„ÙŠÙ„ AI â†’ Ø¥Ø´Ø¹Ø§Ø± Ø­Ø³Ø¨ Ø§Ù„Ù†ØªÙŠØ¬Ø©",
    cat: "ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„", diff: "Ù…ØªÙˆØ³Ø·",
    steps: [
      { icon: "ğŸ“Š", piece: "Google Sheets", action: "Ø¹Ù…Ù„Ø§Ø¡ 30+ ÙŠÙˆÙ…", status: "needs_config" },
      { icon: "ğŸ“§", piece: "Gmail", action: "Ø¥Ø±Ø³Ø§Ù„ Ø±Ø§Ø¨Ø· Ø§Ù„Ø§Ø³ØªØ¨ÙŠØ§Ù†", status: "needs_config" },
      { icon: "ğŸ¤–", piece: "OpenAI", action: "ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø±Ø¯ÙˆØ¯ Ø¨Ù€ AI", status: "ready" },
      { icon: "ğŸ’¬", piece: "Slack", action: "Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„ÙØ±ÙŠÙ‚", status: "needs_config" },
    ]
  },
  enterprise_full: {
    displayName: "ğŸ¢ Enterprise Flow OS",
    desc: "7 Ù…Ø±Ø§Ø­Ù„: Ø¬Ø°Ø¨ â†’ Ù…Ø¨ÙŠØ¹Ø§Øª â†’ ØªØ´ØºÙŠÙ„ â†’ ÙÙˆØªØ±Ø© â†’ Ø±Ø¶Ø§ â†’ ØªØ¬Ø¯ÙŠØ¯ â†’ ØªÙ‚Ø§Ø±ÙŠØ±",
    cat: "Enterprise", diff: "Ù…ØªÙ‚Ø¯Ù…",
    steps: [
      { icon: "ğŸ“Š", piece: "Google Sheets", action: "ØªØ³Ø¬ÙŠÙ„ ÙÙŠ CRM Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ", status: "needs_config" },
      { icon: "ğŸ¤–", piece: "OpenAI", action: "ØªØ­Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„ + ØªÙˆØ¬ÙŠÙ‡", status: "ready" },
      { icon: "ğŸ“§", piece: "Gmail", action: "Ø±Ø³Ø§Ù„Ø© ØªØ±Ø­ÙŠØ¨ + Ø¹Ø±Ø¶", status: "needs_config" },
      { icon: "ğŸ’¬", piece: "Slack", action: "ØªÙˆØ¬ÙŠÙ‡ Ù„Ù„Ù‚Ø³Ù… Ø§Ù„Ù…Ù†Ø§Ø³Ø¨", status: "needs_config" },
      { icon: "ğŸ“Š", piece: "Google Sheets", action: "ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø±Ø­Ù„Ø©", status: "needs_config" },
      { icon: "ğŸ“…", piece: "Google Calendar", action: "Ø¬Ø¯ÙˆÙ„Ø© Ù…ØªØ§Ø¨Ø¹Ø©", status: "needs_config" },
    ]
  },
};

function localAI(msg) {
  const m = msg;
  const map = [
    { k: ["Ø¹Ù…Ù„Ø§Ø¡", "lead", "Ø¬Ø°Ø¨", "Ø²ÙˆØ§Ø±", "Ù…ÙˆÙ‚Ø¹"], t: "lead_capture" },
    { k: ["Ù…ØªØ§Ø¨Ø¹", "Ù…Ø¨ÙŠØ¹Ø§Øª", "Ø±Ø¯ÙˆØ§", "Ù…Ø§ Ø±Ø¯"], t: "sales_followup" },
    { k: ["ÙØ§ØªÙˆØ±", "ØªØ°ÙƒÙŠØ±", "ØªØ­ØµÙŠÙ„", "Ø¯ÙØ¹"], t: "invoice_reminder" },
    { k: ["Ø­Ù…Ù„Ø©", "Ø¥ÙŠÙ…ÙŠÙ„", "Ø¨Ø±ÙŠØ¯", "ØªØ³ÙˆÙŠÙ‚"], t: "email_campaign" },
    { k: ["Ø±Ø¶Ø§", "Ø§Ø³ØªØ¨ÙŠØ§Ù†", "ØªÙ‚ÙŠÙŠÙ…"], t: "customer_satisfaction" },
    { k: ["Ø´Ø±ÙƒØ©", "ÙƒØ§Ù…Ù„", "enterprise", "Ø£ØªÙ…ØªØ©"], t: "enterprise_full" },
  ];
  for (const p of map)
    if (p.k.some(k => m.includes(k))) {
      const f = FLOWS[p.t];
      return { templateKey: p.t, explanation: f.desc, template: f };
    }
  return { templateKey: null, explanation: "Ù…Ø§ Ù‚Ø¯Ø±Øª Ø£Ø­Ø¯Ø¯ ÙˆØ´ ØªØ¨ÙŠ. ÙˆØ¶Ù‘Ø­ Ø£ÙƒØ«Ø±: Ø¬Ø°Ø¨ Ø¹Ù…Ù„Ø§Ø¡ØŸ Ù…ØªØ§Ø¨Ø¹Ø© Ù…Ø¨ÙŠØ¹Ø§ØªØŸ ØªØ°ÙƒÙŠØ± ÙÙˆØ§ØªÙŠØ±ØŸ", template: null };
}

const QA = [
  { emoji: "ğŸ“¥", label: "Ø¬Ø°Ø¨ Ø¹Ù…Ù„Ø§Ø¡", prompt: "Ø£Ø¨ÙŠ Ù†Ø¸Ø§Ù… ÙŠØ¬Ø°Ø¨ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ù…Ù† Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙˆÙŠØµÙ†ÙÙ‡Ù… ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹" },
  { emoji: "ğŸ’°", label: "Ù…ØªØ§Ø¨Ø¹Ø© Ù…Ø¨ÙŠØ¹Ø§Øª", prompt: "Ø£Ø¨ÙŠ Ù…ØªØ§Ø¨Ø¹Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ù„ÙŠ Ù…Ø§ Ø±Ø¯ÙˆØ§" },
  { emoji: "ğŸ“§", label: "Ø­Ù…Ù„Ø© Ø¨Ø±ÙŠØ¯ÙŠØ©", prompt: "Ø£Ø¨ÙŠ Ø­Ù…Ù„Ø© Ø¥ÙŠÙ…ÙŠÙ„Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ø¬Ø¯Ø¯" },
  { emoji: "âš ï¸", label: "ØªØ°ÙƒÙŠØ± ÙÙˆØ§ØªÙŠØ±", prompt: "Ø£Ø¨ÙŠ Ù†Ø¸Ø§Ù… ØªØ°ÙƒÙŠØ± ÙÙˆØ§ØªÙŠØ± Ù…Ø¹ ØªØµØ¹ÙŠØ¯ ØªÙ„Ù‚Ø§Ø¦ÙŠ" },
  { emoji: "â­", label: "Ø±Ø¶Ø§ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡", prompt: "Ø£Ø¨ÙŠ Ø§Ø³ØªØ¨ÙŠØ§Ù† Ø±Ø¶Ø§ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¨Ø¹Ø¯ Ø´Ù‡Ø± Ù…Ø¹ ØªØ­Ù„ÙŠÙ„ Ø°ÙƒÙŠ" },
  { emoji: "ğŸ¢", label: "Ø£ØªÙ…ØªØ© Ø§Ù„Ø´Ø±ÙƒØ©", prompt: "Ø£Ø¨ÙŠ Ø£ØªÙ…ØªØ© ÙƒØ§Ù…Ù„Ø© Ù„Ù„Ø´Ø±ÙƒØ© Ù…Ù† Ø¬Ø°Ø¨ Ø§Ù„Ø¹Ù…ÙŠÙ„ Ù„Ù„ØªØ­ØµÙŠÙ„" },
];

function SplashScreen({ onComplete }) {
  const [ph, setPh] = useState(0);
  useEffect(() => {
    const t = [
      setTimeout(() => setPh(1), 400),
      setTimeout(() => setPh(2), 1200),
      setTimeout(() => setPh(3), 2200),
      setTimeout(() => onComplete(), 3200),
    ];
    return () => t.forEach(clearTimeout);
  }, [onComplete]);

  return (
    <div style={{ position: "absolute", inset: 0, background: T.bg, display: "flex", alignItems: "center", justifyContent: "center", flexDirection: "column", zIndex: 9999, transition: "opacity 0.8s", opacity: ph >= 3 ? 0 : 1 }}>
      <div style={{ width: 64, height: 64, borderRadius: 16, background: `linear-gradient(135deg,${T.accent},${T.success})`, transform: ph >= 1 ? "scale(1)" : "scale(0) rotate(-180deg)", transition: "all 0.6s cubic-bezier(0.175,0.885,0.32,1.275)", display: "flex", alignItems: "center", justifyContent: "center", fontSize: 28, marginBottom: 24, boxShadow: `0 0 60px ${T.accent}40` }}>ğŸ‘‘</div>
      <div style={{ fontSize: 28, fontWeight: 700, color: T.text, opacity: ph >= 1 ? 1 : 0, transition: "all 0.5s ease 0.2s" }}>Ø³ÙŠØ§Ø¯Ø©</div>
      <div style={{ fontSize: 14, color: T.dim, marginTop: 8, opacity: ph >= 2 ? 1 : 0, transition: "all 0.5s ease" }}>Ø§ÙƒØªØ¨. Ø£ØªÙ…Øª. Ø³ÙØ¯.</div>
    </div>
  );
}

function WowMoment({ onDismiss }) {
  const [step, setStep] = useState(0);
  const [typed, setTyped] = useState("");
  const [fsteps, setFsteps] = useState([]);
  const mr = useRef(true);
  const full = "Ø£Ø¨ÙŠ Ø£ØªØ§Ø¨Ø¹ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ù…Ø­ØªÙ…Ù„ÙŠÙ† Ù…Ù† Ø§Ù„Ù…ÙˆÙ‚Ø¹";

  useEffect(() => () => { mr.current = false }, []);

  useEffect(() => {
    if (step !== 1) return;
    let i = 0;
    const iv = setInterval(() => {
      if (!mr.current) { clearInterval(iv); return; }
      if (i <= full.length) { setTyped(full.slice(0, i)); i++; }
      else { clearInterval(iv); setTimeout(() => { if (mr.current) setStep(2) }, 600); }
    }, 45);
    return () => clearInterval(iv);
  }, [step]);

  useEffect(() => {
    if (step !== 2) return;
    const ss = [
      { icon: "ğŸ””", name: "Webhook", desc: "Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª", d: 0 },
      { icon: "ğŸ¤–", name: "AI ØªØ­Ù„ÙŠÙ„", desc: "ØªØµÙ†ÙŠÙ ØªÙ„Ù‚Ø§Ø¦ÙŠ", d: 400 },
      { icon: "ğŸ“Š", name: "Google Sheets", desc: "Ø­ÙØ¸ ÙÙŠ CRM", d: 800 },
      { icon: "ğŸ“§", name: "Gmail", desc: "Ø±Ø³Ø§Ù„Ø© ØªØ±Ø­ÙŠØ¨", d: 1200 },
      { icon: "ğŸ’¬", name: "Slack", desc: "Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„ÙØ±ÙŠÙ‚", d: 1600 },
    ];
    const timers = ss.map(s => setTimeout(() => { if (mr.current) setFsteps(p => [...p, s]) }, s.d));
    timers.push(setTimeout(() => { if (mr.current) setStep(3) }, 2800));
    return () => timers.forEach(clearTimeout);
  }, [step]);

  return (
    <div style={{ position: "absolute", inset: 0, background: T.bg, display: "flex", flexDirection: "column", alignItems: "center", justifyContent: "center", padding: 40, zIndex: 999 }}>
      {step === 0 && (
        <div style={{ textAlign: "center", animation: "fadeUp 0.5s ease" }}>
          <div style={{ fontSize: 44, marginBottom: 16 }}>âœ¨</div>
          <h1 style={{ fontSize: 26, color: T.text, fontWeight: 700, marginBottom: 12 }}>Ø´ÙˆÙ ÙƒÙŠÙ ÙŠØ´ØªØºÙ„</h1>
          <p style={{ fontSize: 15, color: T.dim, marginBottom: 32, lineHeight: 1.6 }}>Ø¬Ù…Ù„Ø© ÙˆØ§Ø­Ø¯Ø© â€” Ù†Ø¸Ø§Ù… Ø£ØªÙ…ØªØ© ÙƒØ§Ù…Ù„</p>
          <button onClick={() => setStep(1)} style={{ background: `linear-gradient(135deg,${T.accent},${T.accentLight})`, color: "#fff", border: "none", borderRadius: 12, padding: "14px 40px", fontSize: 16, fontWeight: 600, cursor: "pointer", boxShadow: `0 4px 24px ${T.accent}40` }}>Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¹Ø±Ø¶ â†</button>
        </div>
      )}
      {step >= 1 && step < 3 && (
        <div style={{ width: "100%", maxWidth: 560 }}>
          <div style={{ background: T.card, borderRadius: 16, padding: 20, border: `1px solid ${T.border}`, marginBottom: 24 }}>
            <div style={{ fontSize: 12, color: T.dim, marginBottom: 12, textAlign: "right" }}>ğŸ’¬ Ø§ÙƒØªØ¨ Ø·Ù„Ø¨Ùƒ</div>
            <div style={{ fontSize: 18, color: T.text, direction: "rtl", minHeight: 28 }}>
              {typed}
              {step === 1 && <span style={{ display: "inline-block", width: 2, height: 22, background: T.accent, animation: "wowBlink 0.8s infinite" }} />}
            </div>
          </div>
          {step >= 2 && (
            <div style={{ direction: "rtl" }}>
              <div style={{ fontSize: 13, color: T.success, marginBottom: 16, display: "flex", alignItems: "center", gap: 6 }}>
                <span style={{ display: "inline-block", width: 8, height: 8, borderRadius: "50%", background: T.success, animation: "wowPulse 1s infinite" }} />
                Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ù†Ø§Ø¡...
              </div>
              {fsteps.map((s, i) => (
                <div key={i}>
                  <div style={{ display: "flex", alignItems: "center", gap: 12, padding: "12px 16px", background: T.card, borderRadius: 12, border: `1px solid ${T.border}`, animation: "wowSlideIn 0.4s ease both" }}>
                    <div style={{ width: 40, height: 40, borderRadius: 10, background: T.hover, display: "flex", alignItems: "center", justifyContent: "center", fontSize: 18 }}>{s.icon}</div>
                    <div style={{ flex: 1 }}>
                      <div style={{ fontSize: 14, fontWeight: 600, color: T.text }}>{s.name}</div>
                      <div style={{ fontSize: 12, color: T.dim }}>{s.desc}</div>
                    </div>
                    <span style={{ fontSize: 11, color: T.success }}>âœ“</span>
                  </div>
                  {i < fsteps.length - 1 && <div style={{ width: 2, height: 8, background: T.border, marginRight: 34 }} />}
                </div>
              ))}
            </div>
          )}
        </div>
      )}
      {step === 3 && (
        <div style={{ textAlign: "center", animation: "fadeUp 0.4s ease" }}>
          <div style={{ fontSize: 52, marginBottom: 16 }}>ğŸ‰</div>
          <h2 style={{ fontSize: 24, color: T.text, fontWeight: 700 }}>5 Ø®Ø·ÙˆØ§Øª ÙÙŠ 3 Ø«ÙˆØ§Ù†ÙŠ!</h2>
          <p style={{ fontSize: 14, color: T.dim, margin: "8px 0 32px" }}>âš¡ Ø£Ø³Ø±Ø¹ 50x Ù…Ù† Ø§Ù„Ø¨Ù†Ø§Ø¡ Ø§Ù„ÙŠØ¯ÙˆÙŠ</p>
          <button onClick={onDismiss} style={{ background: `linear-gradient(135deg,${T.accent},${T.accentLight})`, color: "#fff", border: "none", borderRadius: 12, padding: "14px 48px", fontSize: 16, fontWeight: 600, cursor: "pointer", boxShadow: `0 4px 24px ${T.accent}40` }}>Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù†</button>
        </div>
      )}
    </div>
  );
}

function FlowPanel({ flow, onClose }) {
  const [deploying, setDeploying] = useState(false);
  const [deployed, setDeployed] = useState(false);
  return (
    <div style={{ width: 300, background: T.card, overflowY: "auto", padding: 20, borderRight: `1px solid ${T.border}`, flexShrink: 0, animation: "slidePanel 0.3s ease" }}>
      <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 20 }}>
        <h3 style={{ fontSize: 14, color: T.text, fontWeight: 600, margin: 0 }}>{flow.name}</h3>
        <button onClick={onClose} style={{ background: "transparent", border: "none", color: T.dim, cursor: "pointer", fontSize: 18 }}>âœ•</button>
      </div>
      <div style={{ background: T.bg, borderRadius: 8, padding: 12, marginBottom: 16, border: `1px solid ${T.border}` }}>
        <div style={{ display: "flex", justifyContent: "space-between", marginBottom: 8 }}>
          <span style={{ fontSize: 11, color: T.dim }}>Ø§Ù„Ø«Ù‚Ø©</span>
          <span style={{ fontSize: 13, fontWeight: 700, color: T.success }}>{flow.confidence}%</span>
        </div>
        <div style={{ height: 4, borderRadius: 2, background: `${T.success}20` }}>
          <div style={{ height: "100%", borderRadius: 2, background: `linear-gradient(90deg,${T.success},${T.accent})`, width: `${flow.confidence}%`, transition: "width 1s" }} />
        </div>
      </div>
      <div style={{ display: "flex", flexDirection: "column", gap: 2 }}>
        {flow.steps.map((s, i) => (
          <div key={i}>
            <div style={{ display: "flex", alignItems: "center", gap: 10, padding: "10px 12px", borderRadius: 10, background: T.bg, border: `1px solid ${T.border}` }}>
              <div style={{ width: 32, height: 32, borderRadius: 8, background: T.hover, display: "flex", alignItems: "center", justifyContent: "center", fontSize: 14 }}>{s.icon}</div>
              <div style={{ flex: 1, minWidth: 0 }}>
                <div style={{ fontSize: 12, fontWeight: 600, color: T.text }}>{s.piece}</div>
                <div style={{ fontSize: 10, color: T.dim }}>{s.action}</div>
              </div>
              <div style={{ width: 8, height: 8, borderRadius: "50%", background: s.status === "ready" ? T.success : T.warn, flexShrink: 0 }} />
            </div>
            {i < flow.steps.length - 1 && <div style={{ width: 2, height: 10, background: T.border, marginRight: 26 }} />}
          </div>
        ))}
      </div>
      {flow.suggestion && (
        <div style={{ marginTop: 16, padding: 12, borderRadius: 10, background: `${T.accent}10`, border: `1px solid ${T.accent}25`, fontSize: 11, color: T.accentLight, lineHeight: 1.7 }}>ğŸ’¡ {flow.suggestion}</div>
      )}
      <div style={{ display: "flex", gap: 8, marginTop: 16 }}>
        {deployed ? (
          <div style={{ flex: 1, padding: "10px 0", borderRadius: 10, background: `${T.success}15`, textAlign: "center", fontSize: 13, fontWeight: 600, color: T.success, border: `1px solid ${T.success}30` }}>âœ… Ø´ØºÙ‘Ø§Ù„Ø© Ø§Ù„Ø­ÙŠÙ†!</div>
        ) : (
          <button onClick={() => { setDeploying(true); setTimeout(() => { setDeploying(false); setDeployed(true); }, 1500); }} disabled={deploying} style={{ flex: 1, padding: "10px 0", borderRadius: 10, background: deploying ? T.hover : `linear-gradient(135deg,${T.success},#00A884)`, color: deploying ? T.dim : "#fff", border: "none", fontSize: 13, fontWeight: 600, cursor: deploying ? "default" : "pointer", transition: "all 0.3s" }}>
            {deploying ? <span style={{ animation: "chatPulse 0.8s infinite" }}>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ´ØºÙŠÙ„...</span> : "ğŸš€ Ø´ØºÙ‘Ù„ Ø§Ù„Ø¢Ù†"}
          </button>
        )}
        <button style={{ padding: "10px 14px", borderRadius: 10, background: T.bg, color: T.dim, border: `1px solid ${T.border}`, fontSize: 13, cursor: "pointer" }}>âœï¸</button>
      </div>
    </div>
  );
}

function TemplatesPanel({ onSelect }) {
  const cats = {};
  Object.entries(FLOWS).forEach(([k, f]) => { if (!cats[f.cat]) cats[f.cat] = []; cats[f.cat].push({ ...f, key: k }); });
  return (
    <div style={{ flex: 1, overflowY: "auto", padding: 24, direction: "rtl" }}>
      <h2 style={{ fontSize: 18, color: T.text, fontWeight: 600, marginBottom: 24 }}>Ù‚ÙˆØ§Ù„Ø¨ Ø¬Ø§Ù‡Ø²Ø©</h2>
      {Object.entries(cats).map(([cat, items], ci) => (
        <div key={ci} style={{ marginBottom: 24 }}>
          <h3 style={{ fontSize: 13, color: T.dim, marginBottom: 10 }}>{cat}</h3>
          {items.map((item, ii) => (
            <button key={ii} onClick={() => onSelect(item.displayName)} style={{ display: "flex", alignItems: "center", gap: 12, padding: "14px 16px", background: T.card, border: `1px solid ${T.border}`, borderRadius: 12, cursor: "pointer", textAlign: "right", width: "100%", marginBottom: 8, color: T.text, fontFamily: "inherit" }}>
              <div style={{ flex: 1 }}>
                <div style={{ fontSize: 14, fontWeight: 500 }}>{item.displayName}</div>
                <div style={{ fontSize: 11, color: T.dim, marginTop: 4 }}>{item.steps.length} Ø®Ø·ÙˆØ§Øª â€” {item.desc}</div>
              </div>
              <span style={{ fontSize: 10, padding: "3px 8px", borderRadius: 6, background: item.diff === "Ø³Ù‡Ù„" ? `${T.success}15` : item.diff === "Ù…ØªÙˆØ³Ø·" ? `${T.warn}15` : `${T.danger}15`, color: item.diff === "Ø³Ù‡Ù„" ? T.success : item.diff === "Ù…ØªÙˆØ³Ø·" ? T.warn : T.danger }}>{item.diff}</span>
            </button>
          ))}
        </div>
      ))}
    </div>
  );
}

function InsightsPanel({ progress }) {
  const ts = progress.totalSteps * 12;
  const cards = [
    { l: "Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ÙˆÙÙ‘Ø±", v: `${ts} Ø¯`, c: T.accent, i: "â±ï¸" },
    { l: "Ø§Ù„ØªÙƒÙ„ÙØ©", v: `${Math.round(ts * 0.5)} Ø±.Ø³`, c: T.success, i: "ğŸ’°" },
    { l: "Flows", v: progress.flowsBuilt, c: T.warn, i: "âš¡" },
    { l: "Ø®Ø·ÙˆØ§Øª", v: progress.totalSteps, c: T.accentLight, i: "ğŸ“Š" },
  ];
  return (
    <div style={{ flex: 1, overflowY: "auto", padding: 24, direction: "rtl" }}>
      <h2 style={{ fontSize: 18, color: T.text, fontWeight: 600, marginBottom: 24 }}>ØªØ­Ù„ÙŠÙ„Ø§Øª</h2>
      {progress.flowsBuilt === 0 ? (
        <div style={{ textAlign: "center", marginTop: 60, color: T.dim }}>
          <div style={{ fontSize: 40, marginBottom: 12 }}>ğŸ“Š</div>
          <div style={{ fontSize: 14 }}>Ø§Ø¨Ù†Ù Ø£ÙˆÙ„ Flow Ø¹Ø´Ø§Ù† ØªØ´ÙˆÙ Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª</div>
        </div>
      ) : (
        <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: 12 }}>
          {cards.map((c, i) => (
            <div key={i} style={{ background: T.card, borderRadius: 12, padding: 16, border: `1px solid ${T.border}`, animation: `fadeUp 0.4s ease ${i*0.08}s both` }}>
              <div style={{ fontSize: 20, marginBottom: 8 }}>{c.i}</div>
              <div style={{ fontSize: 22, fontWeight: 700, color: c.c }}>{c.v}</div>
              <div style={{ fontSize: 11, color: T.dim, marginTop: 4 }}>{c.l}</div>
            </div>
          ))}
        </div>
      )}
    </div>
  );
}

function SettingsPanel() {
  const [saved, setSaved] = useState(false);
  return (
    <div style={{ flex: 1, overflowY: "auto", padding: 24, direction: "rtl" }}>
      <h2 style={{ fontSize: 18, color: T.text, fontWeight: 600, marginBottom: 24 }}>Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h2>
      <div style={{ background: T.card, borderRadius: 14, padding: 20, border: `1px solid ${T.border}`, marginBottom: 20 }}>
        <h3 style={{ fontSize: 14, color: T.text, fontWeight: 600, marginBottom: 16 }}>ğŸ”§ Activepieces</h3>
        {["Ø±Ø§Ø¨Ø· Activepieces", "API Token", "Project ID"].map((label, i) => (
          <div key={i} style={{ marginBottom: 16 }}>
            <label style={{ fontSize: 12, color: T.dim, marginBottom: 6, display: "block" }}>{label}</label>
            <input style={{ width: "100%", padding: "10px 14px", borderRadius: 10, background: T.bg, border: `1px solid ${T.border}`, color: T.text, fontSize: 14, outline: "none", direction: "ltr", fontFamily: "monospace", boxSizing: "border-box" }} />
          </div>
        ))}
        <button style={{ padding: "8px 20px", borderRadius: 8, background: T.accent, color: "#fff", border: "none", fontSize: 13, cursor: "pointer" }}>ğŸ”Œ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„</button>
      </div>
      <div style={{ background: T.card, borderRadius: 14, padding: 20, border: `1px solid ${T.border}` }}>
        <h3 style={{ fontSize: 14, color: T.text, fontWeight: 600, marginBottom: 16 }}>ğŸ¢ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø±ÙƒØ©</h3>
        {["Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ©", "Ø§Ù„ØµÙ†Ø§Ø¹Ø©", "Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©"].map((label, i) => (
          <div key={i} style={{ marginBottom: 16 }}>
            <label style={{ fontSize: 12, color: T.dim, marginBottom: 6, display: "block" }}>{label}</label>
            <input style={{ width: "100%", padding: "10px 14px", borderRadius: 10, background: T.bg, border: `1px solid ${T.border}`, color: T.text, fontSize: 14, outline: "none", direction: "rtl", fontFamily: "inherit", boxSizing: "border-box" }} />
          </div>
        ))}
        <button onClick={() => { setSaved(true); setTimeout(() => setSaved(false), 2000); }} style={{ padding: "8px 20px", borderRadius: 8, background: saved ? T.success : T.accent, color: "#fff", border: "none", fontSize: 13, cursor: "pointer", transition: "background 0.3s" }}>{saved ? "âœ… ØªÙ… Ø§Ù„Ø­ÙØ¸!" : "ğŸ’¾ Ø­ÙØ¸"}</button>
      </div>
    </div>
  );
}

function ConnectionsPanel() {
  const svcs = [
    { name: "Google (Gmail, Sheets, Calendar)", icon: "ğŸ”µ", def: false },
    { name: "WhatsApp Business", icon: "ğŸ’š", def: false },
    { name: "Slack", icon: "ğŸ’¬", def: false },
    { name: "OpenAI", icon: "ğŸ¤–", def: true },
    { name: "Telegram", icon: "ğŸ“±", def: false },
  ];
  const [conns, setConns] = useState(svcs.map(s => s.def));
  return (
    <div style={{ flex: 1, overflowY: "auto", padding: 24, direction: "rtl" }}>
      <h2 style={{ fontSize: 18, color: T.text, fontWeight: 600, marginBottom: 8 }}>ğŸ”Œ Ø±Ø¨Ø· Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª</h2>
      <p style={{ fontSize: 12, color: T.dim, marginBottom: 20, lineHeight: 1.6 }}>Ø§Ø±Ø¨Ø· Ø­Ø³Ø§Ø¨Ø§ØªÙƒ Ø¹Ø´Ø§Ù† Ø³ÙŠØ§Ø¯Ø© ÙŠÙ‚Ø¯Ø± ÙŠØ´ØºÙ‘Ù„ Ø§Ù„Ø£ØªÙ…ØªØ©</p>
      {svcs.map((s, i) => (
        <div key={i} style={{ display: "flex", alignItems: "center", gap: 12, padding: "14px 16px", background: T.card, borderRadius: 12, border: `1px solid ${conns[i] ? T.success+"40" : T.border}`, marginBottom: 8, animation: `fadeUp 0.4s ease ${i*0.06}s both` }}>
          <div style={{ width: 38, height: 38, borderRadius: 10, background: T.hover, display: "flex", alignItems: "center", justifyContent: "center", fontSize: 18 }}>{s.icon}</div>
          <div style={{ flex: 1 }}>
            <div style={{ fontSize: 13, fontWeight: 500, color: T.text }}>{s.name}</div>
            <div style={{ fontSize: 10, color: conns[i] ? T.success : T.dim, marginTop: 2 }}>{conns[i] ? "âœ“ Ù…ØªØµÙ„" : "ØºÙŠØ± Ù…Ø±Ø¨ÙˆØ·"}</div>
          </div>
          <button onClick={() => { const c = [...conns]; c[i] = !c[i]; setConns(c); }} style={{ padding: "6px 16px", borderRadius: 8, background: conns[i] ? `${T.success}15` : T.accent, color: conns[i] ? T.success : "#fff", border: conns[i] ? `1px solid ${T.success}30` : "none", fontSize: 11, cursor: "pointer", fontWeight: 500 }}>{conns[i] ? "âœ“ Ù…ØªØµÙ„" : "Ø±Ø¨Ø·"}</button>
        </div>
      ))}
    </div>
  );
}

function Sidebar({ activeTab, setActiveTab }) {
  const tabs = [
    { id: "chat", icon: "ğŸ’¬", tip: "Ø´Ø§Øª" }, { id: "templates", icon: "ğŸ“‹", tip: "Ù‚ÙˆØ§Ù„Ø¨" },
    { id: "connections", icon: "ğŸ”Œ", tip: "Ø±Ø¨Ø·" }, { id: "insights", icon: "ğŸ“Š", tip: "ØªØ­Ù„ÙŠÙ„Ø§Øª" }, { id: "settings", icon: "âš™ï¸", tip: "Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª" },
  ];
  return (
    <div style={{ width: 56, background: T.card, borderLeft: `1px solid ${T.border}`, display: "flex", flexDirection: "column", alignItems: "center", paddingTop: 16, gap: 4, flexShrink: 0 }}>
      <div style={{ width: 34, height: 34, borderRadius: 10, background: `linear-gradient(135deg,${T.accent},${T.success})`, display: "flex", alignItems: "center", justifyContent: "center", fontSize: 16, marginBottom: 20, boxShadow: `0 2px 12px ${T.accent}30` }}>ğŸ‘‘</div>
      {tabs.map(t => (
        <button key={t.id} onClick={() => setActiveTab(t.id)} title={t.tip} style={{ width: 42, height: 42, borderRadius: 10, background: activeTab === t.id ? `${T.accent}20` : "transparent", border: activeTab === t.id ? `1px solid ${T.accent}40` : "1px solid transparent", cursor: "pointer", display: "flex", alignItems: "center", justifyContent: "center", fontSize: 17, color: T.text, transition: "all 0.15s" }}>{t.icon}</button>
      ))}
    </div>
  );
}

function ProgressBar({ progress }) {
  const lv = Math.floor(progress.xp / 100) + 1;
  const xp = progress.xp % 100;
  const badges = [];
  if (progress.flowsBuilt >= 1) badges.push("ğŸ¯");
  if (progress.flowsBuilt >= 3) badges.push("âš¡");
  if (progress.totalSteps >= 20) badges.push("ğŸ—ï¸");
  return (
    <div style={{ padding: "10px 20px", background: T.card, borderBottom: `1px solid ${T.border}`, display: "flex", alignItems: "center", gap: 16, direction: "rtl", flexWrap: "wrap" }}>
      <div style={{ display: "flex", alignItems: "center", gap: 8 }}>
        <div style={{ width: 30, height: 30, borderRadius: 8, background: `linear-gradient(135deg,${T.accent},${T.accentLight})`, display: "flex", alignItems: "center", justifyContent: "center", fontSize: 13, fontWeight: 700, color: "#fff" }}>{lv}</div>
        <div>
          <div style={{ fontSize: 10, color: T.dim }}>Ø§Ù„Ù…Ø³ØªÙˆÙ‰</div>
          <div style={{ width: 50, height: 3, borderRadius: 2, background: `${T.accent}20`, marginTop: 2 }}>
            <div style={{ width: `${xp}%`, height: "100%", borderRadius: 2, background: T.accent, transition: "width 0.5s" }} />
          </div>
        </div>
      </div>
      <div style={{ display: "flex", gap: 12, fontSize: 11, color: T.dim }}>
        <span>âš¡ {progress.flowsBuilt} flows</span>
        <span>ğŸ“Š {progress.totalSteps} Ø®Ø·ÙˆØ©</span>
      </div>
      {badges.length > 0 && (
        <div style={{ display: "flex", gap: 4, marginRight: "auto" }}>
          {badges.map((b, i) => (
            <div key={i} style={{ width: 24, height: 24, borderRadius: 6, background: T.hover, display: "flex", alignItems: "center", justifyContent: "center", fontSize: 12, border: `1px solid ${T.border}` }}>{b}</div>
          ))}
        </div>
      )}
    </div>
  );
}

function ChatBuilder({ progress, setProgress }) {
  const [msgs, setMsgs] = useState([]);
  const [input, setInput] = useState("");
  const [thinking, setThinking] = useState(false);
  const [activeFlow, setActiveFlow] = useState(null);
  const [showFP, setShowFP] = useState(false);
  const endRef = useRef(null);
  const lastRef = useRef(0);

  useEffect(() => { endRef.current?.scrollIntoView({ behavior: "smooth" }) }, [msgs, thinking]);

  const process = useCallback((msg) => {
    setThinking(true);
    setTimeout(() => {
      const result = localAI(msg);
      if (result.template) {
        const t = result.template;
        const fd = {
          name: t.displayName, templateKey: result.templateKey,
          confidence: 88 + Math.floor(Math.random() * 10),
          steps: t.steps, suggestion: result.explanation,
        };
        setActiveFlow(fd); setShowFP(true);
        setProgress(p => ({ ...p, flowsBuilt: p.flowsBuilt + 1, totalSteps: p.totalSteps + fd.steps.length, xp: p.xp + (fd.steps.length * 15) }));
        setMsgs(p => [...p, { role: "assistant", content: fd.name, subtext: `${fd.steps.length} Ø®Ø·ÙˆØ§Øª Ø¨Ø«Ù‚Ø© ${fd.confidence}%`, flow: fd }]);
      } else {
        setMsgs(p => [...p, { role: "assistant", content: result.explanation }]);
      }
      setThinking(false);
    }, 800);
  }, [setProgress]);

  const send = () => {
    const c = sanitize(input); if (!c || thinking) return;
    const n = Date.now(); if (n - lastRef.current < RATE_MS) return;
    lastRef.current = n;
    setMsgs(p => [...p, { role: "user", content: c }]);
    setInput(""); process(c);
  };

  const quick = (pr) => {
    if (thinking) return;
    const n = Date.now(); if (n - lastRef.current < RATE_MS) return;
    lastRef.current = n;
    setMsgs(p => [...p, { role: "user", content: pr }]);
    process(pr);
  };

  return (
    <div style={{ display: "flex", flex: 1, direction: "rtl", minHeight: 0 }}>
      <div style={{ flex: 1, display: "flex", flexDirection: "column", background: T.bg, minWidth: 0 }}>
        <div style={{ flex: 1, overflowY: "auto", padding: "20px 20px", display: "flex", flexDirection: "column", gap: 14 }}>
          {msgs.length === 0 && (
            <div style={{ flex: 1, display: "flex", flexDirection: "column", alignItems: "center", justifyContent: "center", gap: 20, animation: "fadeUp 0.5s ease" }}>
              <div style={{ fontSize: 42 }}>ğŸ‘‘</div>
              <h2 style={{ fontSize: 20, color: T.text, fontWeight: 600, margin: 0 }}>ÙˆØ´ ØªØ¨ÙŠ ØªØ£ØªÙ…ØªØŸ</h2>
              <p style={{ fontSize: 13, color: T.dim, textAlign: "center", maxWidth: 360, lineHeight: 1.7 }}>Ø§ÙƒØªØ¨ Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠ â€” Ø³ÙŠØ§Ø¯Ø© ÙŠØ¨Ù†ÙŠ Ù†Ø¸Ø§Ù… Ø£ØªÙ…ØªØ© ÙƒØ§Ù…Ù„</p>
              <div style={{ display: "grid", gridTemplateColumns: "repeat(3, 1fr)", gap: 8, width: "100%", maxWidth: 400 }}>
                {QA.map((q, i) => (
                  <button key={i} onClick={() => quick(q.prompt)} style={{ background: T.card, border: `1px solid ${T.border}`, borderRadius: 12, padding: "12px 8px", cursor: "pointer", display: "flex", flexDirection: "column", alignItems: "center", gap: 6, color: T.text, fontFamily: "inherit" }}>
                    <span style={{ fontSize: 20 }}>{q.emoji}</span>
                    <span style={{ fontSize: 11, fontWeight: 500 }}>{q.label}</span>
                  </button>
                ))}
              </div>
            </div>
          )}
          {msgs.map((m, i) => (
            <div key={i} style={{ display: "flex", justifyContent: m.role === "user" ? "flex-start" : "flex-end", animation: "fadeUp 0.3s ease" }}>
              <div style={{ maxWidth: "80%", padding: "12px 16px", borderRadius: m.role === "user" ? "16px 16px 4px 16px" : "16px 16px 16px 4px", background: m.role === "user" ? T.accent : T.card, color: m.role === "user" ? "#fff" : T.text, fontSize: 14, lineHeight: 1.7, border: m.role === "user" ? "none" : `1px solid ${T.border}`, whiteSpace: "pre-line" }}>
                {m.role === "assistant" && m.flow ? (
                  <span>{"ÙÙ‡Ù…Øª Ø·Ù„Ø¨Ùƒ! Ø¨Ù†ÙŠØª Ù„Ùƒ "}<strong>{m.content}</strong>{m.subtext && <span style={{ color: T.dim, fontSize: 12 }}>{" â€” "}{m.subtext}</span>}</span>
                ) : m.content}
                {m.flow && (
                  <button onClick={() => { setActiveFlow(m.flow); setShowFP(true); }} style={{ display: "block", marginTop: 10, padding: "8px 16px", background: `${T.accent}20`, border: `1px solid ${T.accent}40`, borderRadius: 8, color: T.accentLight, fontSize: 12, cursor: "pointer", fontFamily: "inherit" }}>ğŸ‘ï¸ Ø¹Ø±Ø¶ Ø§Ù„Ù€ Flow</button>
                )}
              </div>
            </div>
          ))}
          {thinking && (
            <div style={{ display: "flex", justifyContent: "flex-end", animation: "fadeUp 0.3s ease" }}>
              <div style={{ padding: "12px 20px", borderRadius: "16px 16px 16px 4px", background: T.card, border: `1px solid ${T.border}`, display: "flex", alignItems: "center", gap: 8 }}>
                <span style={{ fontSize: 12, color: T.dim }}>ÙŠØ­Ù„Ù„</span>
                <div style={{ display: "flex", gap: 4 }}>
                  {[0, 1, 2].map(j => <div key={j} style={{ width: 6, height: 6, borderRadius: "50%", background: T.accent, animation: `chatPulse 1s infinite ${j * 0.2}s` }} />)}
                </div>
              </div>
            </div>
          )}
          <div ref={endRef} />
        </div>
        <div style={{ padding: "14px 20px", borderTop: `1px solid ${T.border}` }}>
          <div style={{ display: "flex", gap: 8, alignItems: "center", background: T.card, borderRadius: 14, padding: "4px 4px 4px 14px", border: `1px solid ${T.border}` }}>
            <input value={input} onChange={e => setInput(e.target.value.slice(0, MAX_MSG))} onKeyDown={e => e.key === "Enter" && send()} placeholder="Ø§ÙƒØªØ¨ Ø·Ù„Ø¨Ùƒ Ù‡Ù†Ø§..." disabled={thinking} maxLength={MAX_MSG} style={{ flex: 1, background: "transparent", border: "none", color: T.text, fontSize: 14, outline: "none", direction: "rtl", opacity: thinking ? 0.5 : 1, fontFamily: "inherit" }} />
            <button onClick={send} disabled={!input.trim() || thinking} style={{ width: 38, height: 38, borderRadius: 10, background: input.trim() && !thinking ? `linear-gradient(135deg,${T.accent},${T.accentLight})` : T.hover, border: "none", cursor: input.trim() && !thinking ? "pointer" : "default", display: "flex", alignItems: "center", justifyContent: "center", fontSize: 16, color: input.trim() && !thinking ? "#fff" : T.dim, flexShrink: 0 }}>â†‘</button>
          </div>
        </div>
      </div>
      {showFP && activeFlow && <FlowPanel flow={activeFlow} onClose={() => setShowFP(false)} />}
    </div>
  );
}

function SiyadahApp() {
  const [splash, setSplash] = useState(true);
  const [wow, setWow] = useState(false);
  const [tab, setTab] = useState("chat");
  const [progress, setProgress] = useState({ flowsBuilt: 0, totalSteps: 0, xp: 0 });
  const splashDone = useCallback(() => { setSplash(false); setWow(true); }, []);

  return (
    <div style={{ height: "100vh", display: "flex", flexDirection: "row-reverse", background: T.bg, color: T.text, overflow: "hidden", fontFamily: "'IBM Plex Sans Arabic', system-ui, sans-serif", position: "relative" }}>
      {splash && <SplashScreen onComplete={splashDone} />}
      {wow && <WowMoment onDismiss={() => setWow(false)} />}
      {!splash && !wow && (
        <>
          <Sidebar activeTab={tab} setActiveTab={setTab} />
          <div style={{ flex: 1, display: "flex", flexDirection: "column", minWidth: 0 }}>
            <ProgressBar progress={progress} />
            {tab === "chat" && <ChatBuilder progress={progress} setProgress={setProgress} />}
            {tab === "templates" && <TemplatesPanel onSelect={() => setTab("chat")} />}
            {tab === "insights" && <InsightsPanel progress={progress} />}
            {tab === "settings" && <SettingsPanel />}
            {tab === "connections" && <ConnectionsPanel />}
          </div>
        </>
      )}
    </div>
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(<SiyadahApp />);
</script>
</body>
</html>
